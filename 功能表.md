# Website Monitor System 功能表

## 版本資訊
- 更新日期：2025-09-09
- 版本：v3.2.0
- 最新異動：PDF報表文字排版優化修正

## 核心功能

### 1. 網站監控管理
- ✅ 新增監控網站
- ✅ 編輯監控網站 (v2.5 改良為抽屜式)
- ✅ 刪除監控網站
- ✅ 查看網站詳情
- ✅ 網站狀態監控 (健康/異常/待檢查)

### 2. 監控設定
- ✅ 自訂監控間隔 (30秒-1小時)
- ✅ HTTP/HTTPS 網站支援
- ✅ 自訂狀態碼範圍檢查
- ✅ 內容關鍵字檢查
- ✅ SSL 憑證到期監控

### 3. 資料視覺化
- ✅ 即時監控儀表板
- ✅ 回應時間圖表
- ✅ DNS 查詢時間圖表
- ✅ 可用性統計
- ✅ 停機時間統計
- ✅ 多時間範圍檢視 (1小時-1個月)

### 4. SSL 安全監控
- ✅ SSL 憑證狀態檢查
- ✅ 憑證到期日警示
- ✅ 視覺化 SSL 狀態指示器
  - 🟢 SSL 安全 (>30天到期)
  - 🟡 即將到期 (<30天)
  - 🔴 SSL 錯誤
  - ⚪ HTTP 網站

### 5. 報表生成系統 ⭐ 最新功能
- ✅ **網站詳細頁面報表功能** (v3.0)
  - PDF 報表下載按鈕
  - CSV 數據匯出按鈕
  - 與時間範圍選擇器整合
  - 即時報表生成
- ✅ **PDF報表內容** (v3.2 圖表增強版)
  - 網站基本資訊
  - 統計摘要（可用性、回應時間）
  - 📊 可用性圓餅圖（綠色可用/紅色停機）
  - 📈 回應時間趨勢折線圖（最近30次檢查）
  - 最近監控數據表格
  - 自動時間戳檔案命名
- ✅ **CSV數據匯出**
  - 完整監控數據
  - Excel 相容格式
  - UTF-8 BOM 支援中文
- ✅ **API端點**
  - `/api/reports/:websiteId/pdf` - 單一網站PDF報表
  - `/api/reports/:websiteId/csv` - 單一網站CSV數據
  - `/api/reports/:websiteId/preview` - 報表預覽

### 6. 告警通知系統
- ✅ **Email 告警通知**
  - SMTP 郵件伺服器設定
  - 多收件者支援
  - SSL/TLS 加密連線
  - 連線測試功能
- ✅ **Slack 告警通知**
  - Webhook URL 整合
  - 自訂頻道和使用者名稱
  - 即時訊息推送
  - 連線測試功能
- ✅ **系統設定頁面**
  - 分頁式設定介面 (Email/Slack)
  - 收件者清單管理
  - 告警服務狀態顯示
  - 測試告警發送功能

### 7. 使用者介面
- ✅ 響應式設計
- ✅ Material-UI 元件
- ✅ 中文在地化
- ✅ 直覺式操作介面
- ✅ 左側導航整合設定功能

### 8. 系統架構
- ✅ Docker 容器化部署
- ✅ Nginx 反向代理
- ✅ Node.js Express 後端 API
- ✅ React 前端應用
- ✅ InfluxDB 時序資料庫
- ✅ Grafana 進階視覺化

## API 端點

### 網站管理
- `GET /api/websites` - 取得所有網站
- `POST /api/websites` - 新增網站
- `GET /api/websites/:id` - 取得特定網站
- `PUT /api/websites/:id` - 更新網站設定 ✅
- `DELETE /api/websites/:id` - 刪除網站

### 監控數據
- `GET /api/metrics/:websiteId` - 取得監控數據
- `GET /api/metrics/:websiteId/latest` - 取得最新數據
- `GET /api/metrics/:websiteId/stats` - 取得統計資料

### 告警系統 ⭐ 新功能
- `GET /api/alerts/settings` - 取得告警設定
- `PUT /api/alerts/settings` - 更新告警設定
- `POST /api/alerts/test/email` - 測試 Email 連線
- `POST /api/alerts/test/slack` - 測試 Slack 連線
- `POST /api/alerts/test/send` - 發送測試告警

### 報表系統 ⭐ 新功能
- `GET /api/reports/:websiteId/pdf` - 生成單一網站PDF報表
- `GET /api/reports/:websiteId/csv` - 生成單一網站CSV數據
- `GET /api/reports/:websiteId/preview` - 預覽報表數據
- `GET /api/reports/pdf/simple` - 生成簡化版PDF報表（系統整體）

## 頁面路由

### 前端路由
- `/` - 監控儀表板
- `/websites` - 網站列表
- `/websites/add` - 新增網站
- `/websites/:id` - 網站詳情
- `/settings` - 系統設定頁面 ⭐ 新功能

### 管理介面
- `/grafana/` - Grafana 視覺化介面

## 服務狀態測試檢查表

### 基本服務
- [ ] Frontend (React) 服務正常運行
- [ ] Backend (Express API) 服務正常運行  
- [ ] InfluxDB 資料庫服務正常
- [ ] Grafana 視覺化服務正常
- [ ] Nginx 反向代理正常

### 功能測試
- [ ] 新增網站功能正常
- [ ] 編輯網站功能正常 (右側抽屜) ✅
- [ ] 刪除網站功能正常
- [ ] 網站狀態檢查正常
- [ ] SSL 憑證檢查正常
- [ ] 圖表數據顯示正常
- [ ] Grafana 儀表板可訪問
- [ ] 告警設定頁面正常 ⭐ 新功能
- [ ] Email 告警測試正常
- [ ] Slack 告警測試正常
- [ ] 告警發送功能正常
- [ ] PDF報表生成功能正常 ⭐ 最新功能
- [ ] 報表選項API正常 ⭐ 最新功能

## 更新日誌

### v3.2.0 (2025-09-09)
- ✅ **PDF報表文字排版優化**
  - 修正報表中文字擠在一起的問題
  - 增加適當的行間距和字元間距
  - 調整表格列寬，提高內容可讀性
  - 優化摘要統計區塊排版
  - 增加詳細報表各項目間的間距
  - 改善表格分隔線設計和頻率

### v3.1.1 (2025-09-05)
- ✅ **PDF報表版面優化**
  - 所有標題統一左對齊，移除無法顯示的 emoji 符號
  - 現代化環形可用性圓餅圖，添加統計卡片
  - 增強回應時間趨勢圖，填充區域和專業座標軸
  - 修正時間標籤顯示問題，處理多種時間戳格式
- ✅ **視覺設計改進**
  - 專業配色和統一邊距設計
  - 卡片式布局增強視覺層次
  - 圖表容錯機制和異常處理

### v3.1 (2025-09-04)
- ✅ **PDF報表圖表功能**
  - 新增可用性圓餅圖（綠色表示可用，紅色表示停機）
  - 新增回應時間趨勢折線圖（顯示最近30次檢查）
  - 圖表使用 PDFKit 原生繪圖功能
  - 支援網格線和座標軸標籤
- ✅ **圖表視覺化改進**
  - 使用品牌色彩（藍色、綠色、紅色）
  - 自動縮放和數據範圍計算
  - 圖例和時間軸標籤
  - 響應式圖表大小

### v3.0 (2025-09-04)
- ✅ **網站詳細頁面報表生成功能**
  - 在網站詳細頁面新增報表下載按鈕組
  - PDF 和 CSV 兩種格式支援
  - 與時間範圍選擇器整合
  - 即時生成並下載報表
- ✅ **簡化版報表路由實作**
  - 專門為單一網站設計的報表路由
  - 無需 InfluxDB 直接連線
  - 使用現有 API 獲取數據
  - 輕量化實作，提高穩定性
- ✅ **前端整合改善**
  - 新增 reportsApi 服務
  - 報表下載進度指示
  - 錯誤處理機制

### v2.8 (2025-09-04)
- ✅ **PDF報表生成系統實作**
  - PDFKit 輕量化PDF生成庫整合
  - 簡化版PDF報表功能 (基礎版)
  - 網站狀態摘要表格顯示
  - 自動時間戳檔案命名
  - Docker容器環境相容性優化
- ✅ **報表API端點**
  - `/api/reports/pdf/simple` - 簡化版PDF報表生成
  - `/api/reports/options` - 報表生成選項查詢
  - 多時間範圍支援 (1h-30d)
  - RESTful API設計模式

### v2.7 (2025-09-04)
- ✅ **告警通知系統實作**
  - Email 和 Slack 雙通道告警支援
  - 系統設定頁面 (分頁式介面)
  - 左側導航整合設定功能
  - AlertService 服務層實作
  - 完整的告警 API 端點
  - 連線測試和測試告警功能
- ✅ **監控系統整合**
  - 三狀態監控 (Normal → Suspicious → Down)
  - 告警防振盪機制
  - 個別網站監控排程
  - 優雅服務關閉處理

### v2.6 (2025-09-03)
- ✅ 移除防火牆白名單工具 (configure-firewall.sh)
- ✅ 清理相關配置檔案
- ✅ 系統簡化維護

### v2.5 (2025-09-01)
- ✅ 改良編輯功能為右側抽屜彈出式設計
- ✅ 移除獨立編輯頁面，改用 Drawer 組件
- ✅ 優化使用者體驗，無需頁面跳轉
- ✅ 即時預覽設定變更
- ✅ 保持在網站列表頁面操作

### v2.4 (2025-09-01)
- ✅ 新增網站編輯功能基礎實作
- ✅ 建立完整的編輯表單驗證
- ✅ 後端 PUT API 支援完整

### v2.3 (2025-09-01)
- ✅ 新增 SSL 憑證到期狀態顯示
- ✅ 網站列表顯示 SSL 安全狀態
- ✅ 憑證到期警示功能

### v2.2 (2025-09-01)
- ✅ 修改統計顯示：總檢查次數 → 停機時間
- ✅ 移除傳輸速率圖表
- ✅ 優化統計數據呈現

### v2.1 (2025-09-01)
- ✅ 修復 SSL 憑證檢查邏輯
- ✅ 新增 SNI 支援
- ✅ 修復 Grafana 無限重新導向問題

### v2.0 (2025-09-01)
- ✅ 修復導航欄文字顯示問題
- ✅ 改善 Material-UI 與 Tailwind 整合

### v1.0 (2025-09-01)
- ✅ 基礎監控系統建立
- ✅ Docker 容器化部署
- ✅ 核心監控功能實作
