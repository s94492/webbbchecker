# v3.2 版本更新日誌
發布日期：2025-09-04

## 主要更新

### PDF報表圖表功能
為PDF報表新增了視覺化圖表功能，讓監控數據更加直觀易懂。

### 新增功能

1. **可用性圓餅圖**
   - 綠色區域表示正常運行時間
   - 紅色區域表示停機時間
   - 中央顯示可用性百分比
   - 右側圖例說明

2. **回應時間趨勢折線圖**
   - 顯示最近30次檢查的回應時間變化
   - 藍色折線和數據點
   - Y軸顯示回應時間範圍（最大、最小、中間值）
   - X軸顯示時間範圍（開始和結束時間）
   - 灰色網格線增強可讀性

3. **圖表設計特色**
   - 使用品牌一致的色彩主題
   - 自動計算數據範圍和比例
   - 響應式大小適應不同數據量
   - 中文字體支援（Noto Sans TC）

### 技術實作

1. **原生PDFKit繪圖**
   - 使用 PDFKit 內建的繪圖功能
   - 無需額外圖表庫依賴
   - 向量圖形，縮放不失真

2. **數據處理**
   - 自動選取最近30個數據點
   - 動態計算最大最小值
   - 智能處理邊界情況

3. **視覺元素**
   - 座標軸和網格線
   - 圖例和標籤
   - 色彩編碼一致性

### 報表改進

**圓餅圖功能**
- 精確顯示可用性百分比
- 視覺化健康狀態
- 支援100%可用性顯示

**折線圖功能**
- 趨勢分析更加直觀
- 異常波動一目了然
- 性能變化追蹤

### 檔案變更
- 修改：`/backend/src/routes/websiteReports.js`
  - 新增 `drawUptimePieChart()` 圓餅圖繪製函數
  - 新增 `drawResponseTimeChart()` 折線圖繪製函數
  - 更新 PDF 生成流程整合圖表
- 更新：功能表.md 至 v3.2
- 新增：v3.2 版本日誌

### 效能影響
- PDF 檔案大小增加約 5KB（圖表數據）
- 生成時間增加約 200ms
- 無額外記憶體或 CPU 負擔

## 使用示例

### 圓餅圖顯示
- 可用性 99.5% → 綠色圓餅幾乎滿圓
- 停機時間 0.5% → 小紅色區塊
- 中央顯示「99.5%」

### 折線圖顯示
- 橫軸：09:30 - 11:30 （時間範圍）
- 縱軸：120ms - 350ms （回應時間範圍）
- 藍色折線顯示性能趨勢

## 相容性
- 維持原有 PDF 報表格式
- 向下相容所有現有功能
- 中文字體完整支援

## 下一步計劃
- 增加狀態碼分布直條圖
- 支援更多圖表類型
- 報表模板自定義
- 圖表匯出獨立功能
