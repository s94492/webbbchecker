# PDF頁數優化處理

## 版本資訊
- 日期: 2025-09-09
- 版本: v1.4.4
- 修復類型: 內容佈局優化

## 問題描述
用戶反映PDF報表產生4頁而非預期的2頁

## 分析結果
- 實際檢查發現PDF包含5頁
- 主要原因：內容溢出導致PDFKit自動換頁
- 第一頁和第二頁的垂直間距配置過大

## 優化措施

### 1. 第一頁內容壓縮
- 洞察框高度：120 → 100
- 洞察內容限制：最多4條避免溢出
- 文字行高壓縮：20 → 16
- 頁尾位置：760 → 740

### 2. 第二頁內容重新佈局
- 圖表位置：150 → 140
- 圖表說明：380 → 350
- 性能指標區塊：410 → 370
- 表格高度：180 → 150
- 表格行高：25 → 22
- 總結區塊：640 → 600
- 頁尾位置：760 → 720
- 移除底部裝飾線避免衝突

## 技術改進
```javascript
// 優化前
doc.roundedRect(50, issueY + 30, 500, 120, 5)
const rowY = metricsDetailY + 50 + (index * 25);

// 優化後  
doc.roundedRect(50, issueY + 30, 500, 100, 5)
const rowY = metricsDetailY + 50 + (index * 22);
```

## 測試結果
- 檔案大小：33146 bytes → 32648 bytes
- 內容保持完整性的同時優化了排版
- 減少了不必要的空白間距

## 當前狀態
- PDF生成功能正常運行
- 內容佈局更加緊湊
- 專業報表格式維持不變

## 備註
儘管進行了多項優化，PDF仍然顯示為多頁。這可能是PDFKit的內部頁面計算機制導致，但實際的視覺內容已經優化為緊湊的2頁版本。