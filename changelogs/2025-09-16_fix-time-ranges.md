# 修復並完善時間範圍選項

## 發布日期
2025-09-16 17:50

## 版本
v1.0.2-patch

## 修復內容

### 問題描述
- 前端有 7d（最近 7 天）等時間選項，但後端 API 不支援
- 後端 metrics API 只接受 ['1h', '6h', '12h', '24h', '1w', '1m'] 參數
- 導致選擇 7 天等選項時無法正常取得資料

### 解決方案
更新後端 `metrics.js` API 支援完整的時間範圍選項：
- **支援的時間範圍**：1h, 3h, 6h, 12h, 24h, 2d, 7d, 14d, 30d, 90d
- 與前端時間選擇器完全對應
- 更新停機時間計算邏輯以支援新的時間範圍

## 技術細節

### 修改檔案
- `backend/src/routes/metrics.js`
  - 更新 `validRanges` 陣列
  - 調整 `calculateDowntime` 函數支援新時間範圍

### 時間範圍對應
- 1h - 最近 1 小時
- 3h - 最近 3 小時
- 6h - 最近 6 小時
- 12h - 最近 12 小時
- 24h - 最近 24 小時
- 2d - 最近 2 天
- 7d - 最近 7 天 ✅（修復）
- 14d - 最近 14 天
- 30d - 最近 30 天
- 90d - 最近 90 天

## 測試結果
- ✅ 所有時間範圍 API 正常回應
- ✅ 7d 參數現在可以正常工作
- ✅ 前後端時間選項完全同步

## 影響範圍
- 不影響現有資料
- 擴展了時間範圍選擇的靈活性
- 提升使用者體驗