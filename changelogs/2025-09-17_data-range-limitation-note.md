# 資料範圍限制說明

## 發現日期
2025-09-17 11:45

## 問題說明

### 現況
- 系統於 2025/9/1 正式上線
- 目前實際資料範圍：9/10 - 9/17（約 7-8 天）
- 使用者選擇「最近 30 天」時，系統嘗試查詢 8/18 - 9/17 的資料
- 但 8/18 - 9/9 期間無資料，造成圖表失真

### 影響
1. **圖表顯示**：X 軸時間範圍與實際資料不符
2. **統計失真**：SLA 計算基於不完整的資料
3. **使用者誤解**：可能誤以為 8/18 - 9/9 期間服務異常

## 建議解決方案

### 方案一：動態調整時間範圍（推薦）
```javascript
// 檢查實際資料範圍
const actualStartDate = metrics[0]?.time;
const actualEndDate = metrics[metrics.length - 1]?.time;
const actualDays = (actualEndDate - actualStartDate) / (24 * 60 * 60 * 1000);

// 調整顯示範圍
if (actualDays < requestedDays) {
  // 顯示提示：「實際資料範圍：9/10 - 9/17」
}
```

### 方案二：添加資料可用性提示
在圖表和 PDF 報表中加入說明：
- 「資料收集起始日：2025/9/1」
- 「目前可用資料：X 天」

### 方案三：限制時間範圍選項
根據實際資料動態調整可選的時間範圍：
- 如果只有 7 天資料，禁用 14 天、30 天、90 天選項
- 或將這些選項標註為「資料不足」

### 方案四：補充歷史資料說明
在報表中明確標示：
- 實際監控起始日期
- 資料涵蓋範圍
- 避免誤導性的統計

## 實作優先級

1. **立即**：在 PDF 報表中加入資料範圍說明
2. **短期**：在前端界面顯示實際資料範圍
3. **中期**：實作動態時間範圍調整
4. **長期**：考慮資料回補機制

## 注意事項
- 不應顯示不存在的日期標籤（如 8/18 - 8/31）
- SLA 計算應基於實際監控天數，而非選擇的天數
- 明確告知使用者資料的實際範圍，避免誤解