# 優化圖表渲染效能

## 發布日期
2025-09-16 18:10

## 版本
v1.0.4-patch

## 修復內容

### 問題描述
- 圖表渲染大量資料點時效能不佳
- X 軸時間標籤在長時間範圍時過於密集
- 沒有配合後端資料聚合策略優化顯示

### 解決方案

#### 1. 動態時間格式
根據不同時間範圍調整時間顯示格式：
- **1-6小時**：顯示 `HH:mm`（時:分）
- **12-24小時**：顯示 `MM/dd HH:mm`（月/日 時:分）
- **2-7天**：顯示 `MM/dd HH時`（月/日 時）
- **14-90天**：顯示 `MM/dd`（月/日）

#### 2. X軸標籤密度優化
- 長時間範圍（7天以上）隔行顯示標籤，避免重疊
- 根據資料量動態調整顯示間隔：
  - ≤50筆：顯示全部
  - ≤200筆：顯示約20個標籤
  - ≤500筆：顯示約15個標籤
  - \>500筆：顯示約10個標籤

## 技術細節

### 修改檔案
- `frontend/src/pages/WebsiteDetail.js`
  - 更新 `formatMetricsData` 函數，根據時間範圍動態格式化
  - 長時間範圍減少 X 軸標籤密度

- `frontend/src/components/StackedAreaChart.js`
  - 新增 `getXAxisInterval` 函數計算最佳顯示間隔
  - XAxis 組件加入 interval 屬性

## 測試結果
- ✅ 時間格式根據範圍自動調整
- ✅ X 軸標籤不再重疊
- ✅ 圖表渲染流暢度提升
- ✅ 保持資料精度的同時優化視覺呈現

## 效能改善
- 減少 DOM 節點數量
- 優化標籤渲染密度
- 提升大資料量時的互動響應速度

## 影響範圍
- 所有使用圖表的頁面
- 改善使用者體驗，特別是查看長時間範圍資料時