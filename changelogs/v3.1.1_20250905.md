# v3.1.1 版本更新日誌
發布日期：2025-09-05

## 主要更新

### PDF報表版面優化
針對用戶反饋對 PDF 報表進行了全面的版面設計優化，提升專業度和可讀性。

### 新增功能

1. **標題格式標準化**
   - 所有小標題統一左對齊設計
   - 移除標題前符號（📊, 📈 等），解決字型顯示問題
   - 統一使用 Noto Sans TC 中文字體

2. **現代化可用性圓餅圖**
   - 改用環形圖（甜甜圈圖）設計，更具現代感
   - 新增統計卡片顯示詳細數據
   - 專業色彩搭配：綠色表示正常運行，紅色表示停機
   - 中央顯示百分比數值，清晰易讀

3. **增強回應時間趨勢圖**
   - 使用填充區域展示趨勢變化
   - 添加專業座標軸和刻度標籤
   - 垂直和水平網格線增強可讀性
   - Y軸標題旋轉顯示，節省空間
   - 強化數據點顯示，白色邊框突出

4. **時間標籤處理改進**
   - 修正時間戳解析邏輯
   - 處理多種時間格式兼容性
   - 異常處理機制，避免 "Invalid Date" 顯示
   - 備用時間格式自動生成

### 技術改進

1. **圖表繪圖引擎優化**
   - 使用 PDFKit 原生繪圖功能
   - 向量圖形，任意縮放不失真
   - 精細網格線和專業色彩搭配

2. **版面設計改善**
   - 統一邊距和間距設計
   - 卡片式布局增強視覺層次
   - 專業配色：藍色主題色，綠色成功，紅色警告

3. **錯誤處理機制**
   - 時間戳解析異常捕獲
   - 數據缺失時的備用顯示
   - 圖表繪製容錯機制

### 報表改進對比

**優化前問題：**
- 標題使用 emoji 符號無法正確顯示
- 標題對齊不一致
- 圓餅圖設計簡陋
- 時間標籤顯示 "Invalid Date"
- 回應時間圖表缺乏視覺吸引力

**優化後效果：**
- 專業統一的標題格式
- 現代化環形可用性圖表
- 填充式回應時間趨勢圖
- 正確的時間標籤顯示
- 整體視覺效果大幅提升

### 檔案變更
- 修改：`/backend/src/routes/websiteReports.js`
  - 更新 `drawModernUptimeChart()` 現代化圓餅圖函數
  - 新增 `drawEnhancedResponseChart()` 增強回應時間圖表函數
  - 修正時間戳處理邏輯
  - 標題格式標準化
- 新增：v3.1.1 版本日誌

### 效能影響
- PDF 生成時間增加約 50ms（圖表渲染優化）
- 檔案大小維持約 28-30KB
- 圖表品質顯著提升

## 使用示例

### 現代化圓餅圖
- 環形設計，中央顯示可用性百分比
- 左右兩側統計卡片：正常運行 vs 停機時間
- 綠色 #4CAF50 表示健康，紅色 #F44336 表示異常

### 增強回應時間圖表
- 淺藍色填充區域顯示趨勢
- 深藍色折線和數據點
- Y軸顯示回應時間範圍（ms）
- X軸顯示檢查時間範圍
- 專業網格線和座標軸

## 相容性
- 完全向下相容
- 維持原有 API 介面
- 中文字體完整支援
- 所有瀏覽器 PDF 檢視器支援

## 下一步計劃
- 增加更多圖表類型（長條圖、區域圖）
- 支援圖表顏色主題自定義
- 報表模板系統
- 互動式圖表元素