# 監控暫停/恢復功能 - v1.3.0

**發布日期**: 2025-09-09 22:50:00  
**版本**: v1.3.0  
**功能類型**: 新功能

## 功能概述
新增了網站監控的暫停和恢復功能，讓用戶可以臨時停止特定網站的監控，而無需刪除網站配置。

## 新增功能

### 🎯 核心功能
1. **監控暫停**: 可以暫停任何網站的監控服務
2. **監控恢復**: 可以恢復已暫停網站的監控服務
3. **狀態顯示**: 前端清楚顯示網站的監控狀態（運行中/已暫停）
4. **智能按鈕**: 根據當前狀態動態顯示暫停/恢復按鈕

### 🔧 後端實作
- **API端點**:
  - `POST /api/websites/:id/pause` - 暫停監控
  - `POST /api/websites/:id/resume` - 恢復監控
- **監控服務增強**:
  - `stopMonitoring(websiteId)` - 停止特定網站監控
  - `startMonitoring(website)` - 開始特定網站監控
  - `reloadMonitoring()` - 重新加載所有監控狀態
  - `stopAllMonitoring()` - 停止所有監控

### 🎨 前端實作
- **操作按鈕**: 在網站列表中增加暫停/恢復按鈕
- **狀態指示器**: 
  - 暫停圖標: 已暫停的網站顯示暫停圖標
  - 狀態標籤: 顯示「已暫停」標籤
- **API整合**: 
  - `websitesApi.pause(id)` - 暫停網站監控
  - `websitesApi.resume(id)` - 恢復網站監控
- **載入狀態**: 操作過程中顯示載入指示器

## 技術改進

### 📊 資料結構
- 利用現有的 `enabled` 欄位控制監控狀態
- 無需修改資料庫結構，向下相容

### ⚡ 性能優化
- **即時響應**: 暫停/恢復操作立即生效
- **資源管理**: 暫停監控時清除定時器和狀態
- **內存管理**: 清除不必要的監控狀態和告警記錄

### 🔄 狀態管理
- **定時器管理**: 暫停時清除對應的檢查定時器
- **狀態同步**: 前後端狀態即時同步
- **錯誤處理**: 完善的錯誤處理和用戶反饋

## 使用場景

### 🛠 維護場景
- **計劃維護**: 網站維護期間暫停監控避免誤報
- **部署期間**: 部署過程中暫時停止監控
- **測試階段**: 測試環境暫時暫停監控

### 📈 管理場景
- **資源優化**: 臨時減少監控負載
- **成本控制**: 暫停不重要網站的監控
- **故障排查**: 隔離問題網站的監控

## API 範例

### 暫停監控
```bash
curl -X POST "http://localhost/api/websites/{website-id}/pause" \
  -H "Content-Type: application/json"
```

**響應**:
```json
{
  "success": true,
  "message": "網站監控已暫停",
  "data": {
    "id": "website-id",
    "enabled": false,
    "updatedAt": "2025-09-09T14:50:00.000Z"
  }
}
```

### 恢復監控
```bash
curl -X POST "http://localhost/api/websites/{website-id}/resume" \
  -H "Content-Type: application/json"
```

**響應**:
```json
{
  "success": true,
  "message": "網站監控已恢復",
  "data": {
    "id": "website-id",
    "enabled": true,
    "updatedAt": "2025-09-09T14:51:00.000Z"
  }
}
```

## 測試結果

### ✅ 後端測試
- [x] 暫停監控API正常工作
- [x] 恢復監控API正常工作
- [x] 監控服務正確停止/啟動定時器
- [x] 資料庫狀態正確更新

### ✅ 前端測試
- [x] 暫停/恢復按鈕正確顯示
- [x] 載入狀態指示器工作正常
- [x] 狀態圖標和標籤正確更新
- [x] API調用和錯誤處理正常

### ✅ 整合測試
- [x] 前後端狀態同步正常
- [x] 監控服務響應API請求
- [x] 暫停後不再進行監控檢查
- [x] 恢復後立即開始監控檢查

## 影響範圍
- ✅ 不影響現有監控功能
- ✅ 向下相容，無需資料遷移
- ✅ 不影響已配置的告警設定
- ✅ 保留所有歷史監控數據

## 部署狀態
- [x] 後端服務已部署
- [x] 前端介面已更新
- [x] API端點已測試
- [x] 功能完整可用

## 未來規劃
1. **批量操作**: 支援批量暫停/恢復多個網站
2. **定時暫停**: 支援定時自動暫停和恢復
3. **暫停原因**: 記錄暫停原因和操作人員
4. **暫停統計**: 暫停時長和頻率統計