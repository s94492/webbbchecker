# 實作 24 小時圖表整點資料插值

## 發布日期
2025-09-17 11:38

## 版本
v1.0.14-patch

## 新功能

### 功能描述
為 24 小時監控圖表實作整點資料插值，確保 X 軸永遠顯示規律的整點時間。

### 實作邏輯

#### 1. 整點時間序列生成
- 從資料起始時間到結束時間，生成每個整點
- 確保涵蓋完整的 24 小時範圍

#### 2. 智能資料處理策略
針對每個整點時間，採用三層策略：

**第一層：直接使用鄰近資料**
- 如果有資料點在整點前後 30 分鐘內
- 直接使用該資料點的值

**第二層：線性插值**
- 找到整點前後的兩個資料點
- 使用線性插值計算整點的值
- 公式：`value = prev + (next - prev) * ratio`

**第三層：使用最接近點**
- 當無法插值時（如邊界情況）
- 使用最接近整點的資料點

#### 3. 插值計算細節
```javascript
// 對數值型欄位進行插值
responseTime = Math.round(prev + (next - prev) * ratio)
dnsTime = Math.round(prev + (next - prev) * ratio)
// ...

// 對布林值使用 AND 邏輯
isHealthy = prevMetric.isHealthy && nextMetric.isHealthy

// 狀態碼使用前一個值
statusCode = prevMetric.statusCode
```

## 技術細節

### 修改檔案
- `frontend/src/pages/WebsiteDetail.js`
  - 第 227-329 行：新增整點資料生成邏輯
  - 包含資料查找、插值計算、邊界處理

### 關鍵特性
1. **資料完整性**：確保每個整點都有資料
2. **平滑過渡**：使用插值讓資料連續
3. **準確性**：30 分鐘內的資料直接使用，避免不必要的插值

## 測試結果
- ✅ X 軸顯示規律的整點（12:00, 13:00, 14:00...）
- ✅ 資料點準確對應整點時間
- ✅ 圖表曲線平滑連續
- ✅ 消除了時間標籤重複和不均勻問題

## 影響範圍
- 僅影響 24 小時時間範圍的圖表
- 其他時間範圍保持原有邏輯
- 提升圖表專業度和可讀性

## 使用者體驗改進
- 時間軸清晰規律，易於閱讀
- 資料趨勢更加明顯
- 符合專業監控圖表標準