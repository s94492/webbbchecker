# 變更日誌 - v1.1.4

## ⚡ 智能時間單位轉換功能

### 🚀 新增功能

#### 自動時間單位切換
- **智能判斷**: 系統自動分析監控資料的數值範圍
- **動態切換**: 當最大回應時間超過1000ms時，Y軸自動從毫秒(ms)切換為秒(s)
- **一致性**: Tooltip 中的所有時間數值也會對應調整單位

#### 使用者體驗優化
- **視覺清晰**: 避免Y軸數值過大影響圖表可讀性  
- **精度保持**: Tooltip 中仍保持精確的原始數值顯示
- **單位標示**: Y軸標籤清楚顯示當前使用的時間單位

### 🔧 技術實作細節

#### 智能單位判斷演算法
```javascript
// 分析資料範圍，決定最佳顯示單位
const getOptimalUnit = (data) => {
  let maxValue = 0;
  data.forEach(item => {
    const total = dnsTime + connectTime + sslHandshakeTime + 
                  timeToFirstByte + downloadTime;
    maxValue = Math.max(maxValue, total);
  });
  
  // 超過1000ms使用秒為單位
  return maxValue >= 1000 ? 
    { unit: 's', divisor: 1000 } : 
    { unit: 'ms', divisor: 1 };
};
```

#### 數值格式化函數
```javascript
const formatTimeValue = (milliseconds) => {
  if (milliseconds >= 1000) {
    return {
      value: (milliseconds / 1000).toFixed(2),
      unit: 's'
    };
  }
  return {
    value: Math.round(milliseconds),
    unit: 'ms'
  };
};
```

#### 雙重資料處理
- **圖表資料**: 根據單位轉換用於Y軸顯示
- **原始資料**: 保留完整精度供Tooltip使用
- **資料完整性**: 確保轉換過程中沒有精度損失

### 📊 實際應用場景

#### **快速回應網站 (<1000ms)**
```
Y軸: 時間 (ms)
範圍: 0-800ms
顯示: DNS:50ms, 連接:100ms, SSL:150ms...
```

#### **較慢回應網站 (>1000ms)**  
```
Y軸: 時間 (s)
範圍: 0-3.5s
顯示: DNS:0.05s, 連接:0.10s, SSL:0.15s...
```

#### **Tooltip 顯示**
```
不論Y軸單位，Tooltip都顯示最適合的單位:
- 500ms → 500ms
- 1200ms → 1.20s
- 3500ms → 3.50s
```

### 🎯 使用者價值

1. **自動化**: 無需手動切換，系統智能判斷最佳單位
2. **可讀性**: 避免Y軸出現4位數字，保持圖表簡潔
3. **精確性**: Tooltip 提供精確數值，滿足詳細分析需求
4. **一致性**: 整個介面的時間顯示保持統一標準

### 🔄 向下相容性

- ✅ **無破壞性**: 現有功能完全保持
- ✅ **自動適配**: 無需手動配置
- ✅ **資料完整**: 不影響資料精度
- ✅ **介面一致**: 符合現有設計風格

## 🏗️ 架構優化

### 效能考量
- **計算最佳化**: 只在資料變更時重新計算單位
- **記憶體效率**: 避免重複的數值轉換
- **渲染效能**: 不影響圖表渲染速度

### 擴展性設計
- **預留接口**: 可輕鬆添加更多時間單位（分鐘、小時）
- **配置化**: 未來可支援用戶自訂轉換閾值
- **模組化**: 轉換邏輯可復用於其他圖表組件

## ✅ 測試狀態

- 🟢 前端編譯成功
- 🟢 Docker 服務正常
- 🟢 圖表渲染正常
- 🟢 單位轉換邏輯正確
- 🟢 Tooltip 顯示準確

## 📋 使用說明

### 自動觸發條件
- 監控資料中任一時間點的總回應時間 ≥ 1000ms
- Y軸自動切換為秒(s)單位
- 所有相關數值按比例調整

### 檢視詳細資訊
- 滑鼠懸停在圖表上
- Tooltip 顯示精確的原始數值
- 每個時間組成都有對應的最適單位

## 🎨 設計哲學

**"智能簡化，精度不減"** - 通過智能化的單位轉換，讓使用者能夠更輕鬆地閱讀圖表，同時在需要時仍能獲得精確的資料詳情。

---

🔍 **技術重點**: 這項功能展現了前端資料視覺化的細節考量，透過演算法判斷最佳顯示方式，大幅提升使用者體驗。